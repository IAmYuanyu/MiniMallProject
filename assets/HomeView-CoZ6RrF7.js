import{_ as G,r,o as J,c as d,a as i,b as a,w as s,d as n,e as _,u as K,f as o,F as v,g as p,h as m,t as $,s as F}from"./index-Bu6-biGD.js";const O={class:"home"},Q={class:"search-container"},W=["src"],X={class:"category-container"},Y={class:"product-list"},Z={class:"product-info"},ee={class:"product-title"},te={class:"product-price-cart"},ae={class:"product-price"},ne={__name:"HomeView",setup(oe){const I=K(),h=r(""),C=r([]),f=r([]),g=r([]),u=r(!1),y=r(!1),k=r(0),S=r(["全部","菜谱","早餐","休闲","人气"]),U=async()=>{try{const e=await _.get("/banners");e.data.code===200&&(C.value=e.data.data)}catch(e){console.error("获取轮播图失败",e)}},q=async()=>{try{const e=await _.get("/categories");e.data.code===200&&(f.value=e.data.data)}catch(e){console.error("获取分类失败",e)}},w=async()=>{try{u.value=!0;const e=await _.get("/products");e.data.code===200&&(g.value=e.data.data,y.value=!0)}catch(e){console.error("获取商品失败",e)}finally{u.value=!1}},z=async()=>{try{u.value=!0;const e=await _.get(`/search?keyword=${h.value}`);e.data.code===200&&(g.value=e.data.data,y.value=!0)}catch(e){console.error("搜索商品失败",e)}finally{u.value=!1}},H=async e=>{try{(await _.post("/cart/add",{productId:e.id,quantity:1})).data.code===200&&F("添加成功")}catch(c){console.error("添加购物车失败",c),F("添加失败")}},N=e=>{k.value=e,w()},V=e=>{I.push({name:"category",query:{categoryId:e.id}})};return J(()=>{U(),q(),w()}),(e,c)=>{const b=n("van-icon"),R=n("van-search"),D=n("van-swipe-item"),E=n("van-swipe"),B=n("van-grid-item"),T=n("van-grid"),L=n("van-image"),M=n("van-list"),P=n("van-pull-refresh"),j=n("van-tab"),A=n("van-tabs");return o(),d("div",O,[i("div",Q,[a(R,{modelValue:h.value,"onUpdate:modelValue":c[0]||(c[0]=t=>h.value=t),placeholder:"水果",shape:"round",background:"#42b983",onSearch:z},{left:s(()=>[a(b,{name:"location-o",size:"18"})]),right:s(()=>[a(b,{name:"chat-o",size:"18",style:{"margin-right":"10px"}})]),_:1},8,["modelValue"])]),a(E,{class:"banner",autoplay:3e3,"indicator-color":"white"},{default:s(()=>[(o(!0),d(v,null,p(C.value,t=>(o(),m(D,{key:t.id},{default:s(()=>[i("img",{src:t.image,alt:"banner"},null,8,W)]),_:2},1024))),128))]),_:1}),i("div",X,[a(T,{"column-num":5,border:!1},{default:s(()=>[(o(!0),d(v,null,p(f.value.slice(0,5),t=>(o(),m(B,{key:t.id,icon:t.icon,text:t.name,onClick:x=>V(t)},null,8,["icon","text","onClick"]))),128))]),_:1}),a(T,{"column-num":5,border:!1},{default:s(()=>[(o(!0),d(v,null,p(f.value.slice(5,10),t=>(o(),m(B,{key:t.id,icon:t.icon,text:t.name,onClick:x=>V(t)},null,8,["icon","text","onClick"]))),128))]),_:1})]),a(A,{active:k.value,"onUpdate:active":c[2]||(c[2]=t=>k.value=t),onChange:N,sticky:""},{default:s(()=>[(o(!0),d(v,null,p(S.value,(t,x)=>(o(),m(j,{key:x,title:t},{default:s(()=>[a(P,{onRefresh:w},{default:s(()=>[a(M,{loading:u.value,"onUpdate:loading":c[1]||(c[1]=l=>u.value=l),finished:y.value,"finished-text":"没有更多了"},{default:s(()=>[i("div",Y,[(o(!0),d(v,null,p(g.value,l=>(o(),d("div",{class:"product-item",key:l.id},[a(L,{src:l.image,width:"100%",height:"100px"},null,8,["src"]),i("div",Z,[i("div",ee,$(l.title),1),i("div",te,[i("span",ae,"¥"+$(l.price.toFixed(2)),1),a(b,{name:"cart-o",class:"cart-icon",onClick:se=>H(l)},null,8,["onClick"])])])]))),128))])]),_:1},8,["loading","finished"])]),_:1})]),_:2},1032,["title"]))),128))]),_:1},8,["active"])])}}},re=G(ne,[["__scopeId","data-v-0a332d9d"]]);export{re as default};
