import{_ as S,r,c as T,a as l,b as o,d as t,w as n,u as E,g as A,n as d,f as b,z as _,p as F}from"./index-CQ_8GmyQ.js";const I={class:"register-container"},Z={class:"register-header"},$={class:"register-form"},j={class:"gender-field"},D={style:{margin:"16px"}},G={__name:"RegisterView",setup(H){const f=E(),v=r(""),g=r(""),i=r(""),m=r(""),w=r("unknown"),h=[{required:!0,message:"请填写用户名"},{validator:R,message:"用户名长度为3-20个字符"},{validator:U,message:"该用户名已被注册"}],k=[{required:!0,message:"请填写手机号"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号码"}],y=[{required:!0,message:"请填写密码"},{validator:V,message:"密码长度为6-20个字符，需包含字母和数字"}],x=[{required:!0,message:"请确认密码"},{validator:C,message:"两次密码不一致"}];function R(s){return s.length>=1&&s.length<=10}async function U(s){if(s.length<1)return!0;try{return(await b.post("/user/check-username",{username:s})).data.code===200}catch(e){return console.error("检查用户名失败",e),!0}}function V(s){const e=/[a-zA-Z]/.test(s),c=/\d/.test(s);return s.length>=6&&s.length<=20&&e&&c}function C(){return i.value===m.value}const P=()=>{f.back()},q=async s=>{try{if(!V(s.password)){_("密码格式不正确");return}const e=await b.post("/user/register",s);e.data.code===200?(F("注册成功，请登录"),f.push("/login")):_(e.data.message||"注册失败")}catch(e){console.error("注册失败",e),_("注册失败，请重试")}};return(s,e)=>{const c=t("van-nav-bar"),u=t("van-field"),p=t("van-radio"),N=t("van-radio-group"),z=t("van-cell-group"),B=t("van-button"),L=t("van-form");return A(),T("div",I,[l("div",Z,[o(c,{title:"注册","left-arrow":"",onClickLeft:P})]),l("div",$,[o(L,{onSubmit:q},{default:n(()=>[o(z,{inset:""},{default:n(()=>[o(u,{modelValue:v.value,"onUpdate:modelValue":e[0]||(e[0]=a=>v.value=a),name:"username",label:"用户名",placeholder:"请输入用户名",rules:h,class:"custom-field"},null,8,["modelValue"]),o(u,{modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=a=>g.value=a),name:"phone",label:"手机号",placeholder:"请输入手机号",rules:k,class:"custom-field"},null,8,["modelValue"]),o(u,{modelValue:i.value,"onUpdate:modelValue":e[2]||(e[2]=a=>i.value=a),type:"password",name:"password",label:"密码",placeholder:"请输入密码",rules:y,class:"custom-field"},null,8,["modelValue"]),o(u,{modelValue:m.value,"onUpdate:modelValue":e[3]||(e[3]=a=>m.value=a),type:"password",name:"confirmPassword",label:"确认密码",placeholder:"请再次输入密码",rules:x,class:"custom-field"},null,8,["modelValue"]),l("div",j,[e[8]||(e[8]=l("span",{class:"gender-label"},"性别",-1)),o(N,{modelValue:w.value,"onUpdate:modelValue":e[4]||(e[4]=a=>w.value=a),direction:"horizontal"},{default:n(()=>[o(p,{name:"male"},{default:n(()=>e[5]||(e[5]=[d("男")])),_:1,__:[5]}),o(p,{name:"female"},{default:n(()=>e[6]||(e[6]=[d("女")])),_:1,__:[6]}),o(p,{name:"unknown"},{default:n(()=>e[7]||(e[7]=[d("未知")])),_:1,__:[7]})]),_:1},8,["modelValue"])])]),_:1}),l("div",D,[o(B,{round:"",block:"",type:"primary","native-type":"submit"},{default:n(()=>e[9]||(e[9]=[d(" 注册 ")])),_:1,__:[9]})])]),_:1})])])}}},K=S(G,[["__scopeId","data-v-cd66813b"]]);export{K as default};
