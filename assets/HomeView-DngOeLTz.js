import{_ as A,r as i,o as G,c as _,a as t,b as n,w as r,d as s,F as u,e as v,f as m,u as J,g as c,h as V,t as I,s as k}from"./index-DGB3ysgZ.js";import{餐 as K,乳 as O,美 as Q,酒 as W,粮 as X,冰 as Y,海 as Z,肉 as ee,新 as ae,时 as te}from"./时令水果-DDy7EzII.js";const oe={class:"home"},ne={class:"search-container"},se=["src"],ce={class:"category-container"},ie={class:"category-grid"},re=["onClick"],le={class:"category-icon"},_e=["src","alt"],de={class:"category-name"},ue={class:"product-list"},ve={class:"product-info"},me={class:"product-title"},pe={class:"product-price-cart"},he={class:"product-price"},fe={__name:"HomeView",setup(ge){const b=J(),p=i(""),$=i([]),C=i([]),h=i([]),d=i(!1),f=i(!1),g=i(0),B=i(["全部","菜谱","早餐","休闲","人气"]),S=()=>{const e=localStorage.getItem("userInfo");return e&&e!=="null"},T=async()=>{try{const e=await m.get("/banners");e.data.code===200&&($.value=e.data.data)}catch(e){console.error("获取轮播图失败",e)}},F=()=>{C.value=[{id:1,name:"餐饮美食",icon:K},{id:2,name:"乳品烘焙",icon:O},{id:3,name:"美妆百货",icon:Q},{id:4,name:"酒水饮料",icon:W},{id:5,name:"粮油调味",icon:X},{id:6,name:"冰品面点",icon:Y},{id:7,name:"海鲜水产",icon:Z},{id:8,name:"肉禽蛋品",icon:ee},{id:9,name:"新鲜蔬菜",icon:ae},{id:10,name:"时令水果",icon:te}]},y=async()=>{try{d.value=!0;const e=await m.get("/products");e.data.code===200&&(h.value=e.data.data,f.value=!0)}catch(e){console.error("获取商品失败",e)}finally{d.value=!1}},U=async()=>{try{d.value=!0;const e=await m.get(`/search?keyword=${p.value}`);e.data.code===200&&(h.value=e.data.data,f.value=!0)}catch(e){console.error("搜索商品失败",e)}finally{d.value=!1}},q=async e=>{if(!S()){k("请先登录"),b.push("/profile");return}try{(await m.post("/cart/add",{productId:e.id,quantity:1})).data.code===200&&k("添加成功")}catch(o){console.error("添加购物车失败",o),k("添加失败")}},z=e=>{g.value=e,y()},H=e=>{b.push({name:"category",query:{categoryId:e.id}})};return G(()=>{T(),F(),y()}),(e,o)=>{const w=s("van-icon"),L=s("van-search"),N=s("van-swipe-item"),R=s("van-swipe"),D=s("van-image"),E=s("van-list"),M=s("van-pull-refresh"),P=s("van-tab"),j=s("van-tabs");return c(),_("div",oe,[t("div",ne,[n(L,{modelValue:p.value,"onUpdate:modelValue":o[0]||(o[0]=a=>p.value=a),placeholder:"水果",shape:"round",background:"#42b983",onSearch:U},{left:r(()=>[n(w,{name:"location-o",size:"18"})]),right:r(()=>[n(w,{name:"chat-o",size:"18",style:{"margin-right":"10px"}})]),_:1},8,["modelValue"])]),n(R,{class:"banner",autoplay:3e3,"indicator-color":"white"},{default:r(()=>[(c(!0),_(u,null,v($.value,a=>(c(),V(N,{key:a.id},{default:r(()=>[t("img",{src:a.image,alt:"banner"},null,8,se)]),_:2},1024))),128))]),_:1}),t("div",ce,[t("div",ie,[(c(!0),_(u,null,v(C.value,a=>(c(),_("div",{key:a.id,class:"category-item",onClick:x=>H(a)},[t("div",le,[t("img",{src:a.icon,alt:a.name},null,8,_e)]),t("div",de,I(a.name),1)],8,re))),128))])]),n(j,{active:g.value,"onUpdate:active":o[2]||(o[2]=a=>g.value=a),onChange:z,sticky:""},{default:r(()=>[(c(!0),_(u,null,v(B.value,(a,x)=>(c(),V(P,{key:x,title:a},{default:r(()=>[n(M,{onRefresh:y},{default:r(()=>[n(E,{loading:d.value,"onUpdate:loading":o[1]||(o[1]=l=>d.value=l),finished:f.value,"finished-text":"没有更多了"},{default:r(()=>[t("div",ue,[(c(!0),_(u,null,v(h.value,l=>(c(),_("div",{class:"product-item",key:l.id},[n(D,{src:l.image,width:"100%",height:"100px"},null,8,["src"]),t("div",ve,[t("div",me,I(l.title),1),t("div",pe,[t("span",he,"¥"+I(l.price.toFixed(2)),1),n(w,{name:"cart-o",class:"cart-icon",onClick:ye=>q(l)},null,8,["onClick"])])])]))),128))])]),_:1},8,["loading","finished"])]),_:1})]),_:2},1032,["title"]))),128))]),_:1},8,["active"])])}}},ke=A(fe,[["__scopeId","data-v-e1aafc2d"]]);export{ke as default};
